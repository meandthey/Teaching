## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.04*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 900/(z + 3) - 900/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "최적 배출부과금",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "darkgreen")
# 교차점 및 안내선: 가로 선
abline(h = y_star,  lty = 3, col = "gray60")
mtext(expression(t^"*"),
side = 2,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = y_star,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
## 교차점 계산
#diff1 <- function(z) 40 - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
abline(v = q_star ,  lty = 3, col = "gray60")
mtext(expression(e^"*"),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = q_star,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
## 교차점 계산
#diff1 <- function(z) 40 - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
abline(v = 36 ,  lty = 3, col = "gray60")
mtext(expression(e[1]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = 36,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
mtext(expression(e[0]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = 100,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
## 그래프 안쪽에 곡선 제목 붙이기
text(15,70 , "MAC", col = "darkgreen", cex = 1.5)
text(83,40 , "MD", col = "blue", cex = 1.5)
#############################
##### 182 page ##### 그림 8-1
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.04*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 900/(z + 3) - 900/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "최적 배출부과금",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "darkgreen")
#############################
##### 182 page ##### 그림 8-1
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.04*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 500/(z + 3) - 500/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "최적 배출부과금",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "darkgreen")
#############################
##### 182 page ##### 그림 8-1
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.4*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 900/(z + 3) - 900/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "최적 배출부과금",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "darkgreen")
#############################
##### 182 page ##### 그림 8-1
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.4*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 1900/(z + 3) - 1900/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "최적 배출부과금",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "darkgreen")
#############################
##### 182 page ##### 그림 8-1
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향 ↗
supply_fun  <- function(z) 0.00005*z^3 + 0.4*z
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 1900/(z + 3) - 1900/103
## 교차점 계산
diff1 <- function(z) supply_fun(z)  - demand_fun(z)
q_star  <- uniroot(diff1, xlim_all)$root
y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "", ylab = "",
main = "배출권거래제의 효율성(동질적 오염)",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, supply_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun(x), lwd = 3, col = "blue")
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
1  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0, 100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 수요곡선: 우하향 ↘
demand_fun  <- function(z) 2000/(z + 3) - 2000/103
demand_fun_a  <- function(z) 1000/(z + 3) - 1000/103
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "배출권거래제의 기술혁신 유인",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun(x),  lwd = 3, col = "blue")
lines(x, demand_fun_a(x), lwd = 3, col = "blue")
# 교차점 및 안내선: 가로 선
abline(h = demand_fun(35),  lty = 3, col = "gray60")
mtext(expression(P),
side = 2,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = demand_fun(35),      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
## 교차점 계산
#diff1 <- function(z) 40 - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
root_pos_a <- uniroot(function(z) demand_fun_a(z) - demand_fun(35), c(0, 100))$root
abline(v = root_pos_a ,  lty = 3, col = "gray60")
mtext(expression(e[2]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos_a,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
## 교차점 계산
#diff1 <- function(z) 40 - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
root_pos_b <- uniroot(function(z) demand_fun(z) - demand_fun(35), c(0, 100))$root
abline(v = root_pos_b ,  lty = 3, col = "gray60")
mtext(expression(e[1]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos_b,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
# 영점
#root_pos_a <- uniroot(function(z) demand_fun_a(z) - 0, c(0, 100))$root
mtext(expression(0),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = 0,      # 텍스트 좌표 위치
line = 1,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
text(38, 45, expression(MAC[1]), col = "black", cex = 1.5)
text(9, 45, expression(MAC[2]), col = "black", cex = 1.5)
