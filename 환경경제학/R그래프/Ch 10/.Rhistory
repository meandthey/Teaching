plot(NA, xlim=xlim_all, ylim=ylim_all,
xlab=expression(Q), ylab=expression(U^i(Q)),
main="다수결 원칙에 따른 환경질 선택 (b)",
cex.lab=1.8, cex.axis=1.6, cex.main=1.8)
## ---- 효용곡선 모양 설정 (아래로 볼록한 포물선) ----
## U^k(Q) = Hk - a * (Q - Qk)^2
a  <- 0.08                 # 곡률(모양)
QA <- 30; QB <- 60; QC <- 110  # 각 곡선의 정점 위치 (Q^A, Q^B, Q^C)
HA <- 80; HB <- 86; HC <- 92  # 정점 높이(원본처럼 C가 살짝 더 높게)
U <- function(Q, H, Q0, a) H - a*(Q - Q0)^2
## 곡선 그리기
xx <- seq(xlim_all[1], xlim_all[2], length.out=2000)
lines(xx, U(xx, HA, QA, a), lwd=3, col="#1f5aa6")  # U^A(Q)
lines(xx, U(xx, HB, QB, a), lwd=3, col="#1f5aa6")  # U^B(Q)
lines(xx, U(xx, HC, QC, a), lwd=3, col="#1f5aa6")  # U^C(Q)
## ---- 수직 보조선: Q^1, Q^B, Q^2 ----
Q1 <- QA                       # 왼쪽 정점 위치 (Q^1)
Q2 <- QC                       # 오른쪽 정점 위치 (Q^2)
abline(v=Q1-5, lty=3, col="gray65")
abline(v=QB, lty=3, col="gray65")
abline(v=Q2+5, lty=3, col="gray65")
## ---- Q^B에서의 각 효용값: U^A(Q^B), U^C(Q^B), U^B(Q^B) ----
UA_QB <- U(QB, HA, QA, a)
UC_QB <- U(QB, HC, QC, a)
UB_QB <- U(QB, HB, QB, a)
abline(h=UA_QB, lty=3, col="gray65")
abline(h=UC_QB, lty=3, col="gray65")
abline(h=UB_QB, lty=3, col="gray65")
## ---- 축 아래 라벨 (Q^1, Q^B, Q^2) ----
mtext(expression(Q^1), side=1, at=Q1-5, line=1.4, cex=1.5)
mtext(expression(Q^B), side=1, at=QB, line=1.4, cex=1.5)
mtext(expression(Q^2), side=1, at=Q2+5, line=1.4, cex=1.5)
abline(h=0, lwd=1.5, col="black")
## ---- 좌측 y축 라벨 (U^A(Q^B), U^C(Q^B), U^B(Q^B)) ----
# ##    위치는 살짝 왼쪽에 텍스트로 붙임
# text(x=2, y=UA_QB, labels=expression(U^A(Q^B)), adj=c(0,0.5), cex=1.3)
# text(x=2, y=UC_QB, labels=expression(U^C(Q^B)), adj=c(0,0.5), cex=1.3)
# text(x=2, y=UB_QB, labels=expression(U^B(Q^B)), adj=c(0,0.5), cex=1.3)
#
# ## ---- 곡선 하단 라벨 (U^A(Q), U^B(Q), U^C(Q)) ----
# text(QA-10, 5,  labels=expression(U^A(Q)), cex=1.3)
# text(QB,    5,  labels=expression(U^B(Q)), cex=1.3)
# text(QC+10, 5,  labels=expression(U^C(Q)), cex=1.3)
par(oldpar)
oldpar <- par(no.readonly = TRUE)
par(mar=c(5,5,2,2), mgp=c(3,1,0),
xaxs="i", yaxs="i", xaxt="n", yaxt="n")
xlim_all <- c(0, 150)
ylim_all <- c(-150, 100)
plot(NA, xlim=xlim_all, ylim=ylim_all,
xlab=expression(Q), ylab=expression(U^i(Q)),
main="다수결 원칙에 따른 환경질 선택 (b)",
cex.lab=1.8, cex.axis=1.6, cex.main=1.8)
## ---- 효용곡선 모양 설정 (아래로 볼록한 포물선) ----
## U^k(Q) = Hk - a * (Q - Qk)^2
a  <- 0.08                 # 곡률(모양)
QA <- 30; QB <- 60; QC <- 110  # 각 곡선의 정점 위치 (Q^A, Q^B, Q^C)
HA <- 80; HB <- 86; HC <- 92  # 정점 높이(원본처럼 C가 살짝 더 높게)
U <- function(Q, H, Q0, a) H - a*(Q - Q0)^2
## 곡선 그리기
xx <- seq(xlim_all[1], xlim_all[2], length.out=2000)
lines(xx, U(xx, HA, QA, a), lwd=3, col="#1f5aa6")  # U^A(Q)
lines(xx, U(xx, HB, QB, a), lwd=3, col="#1f5aa6")  # U^B(Q)
lines(xx, U(xx, HC, QC, a), lwd=3, col="#1f5aa6")  # U^C(Q)
## ---- 수직 보조선: Q^1, Q^B, Q^2 ----
Q1 <- QA                       # 왼쪽 정점 위치 (Q^1)
Q2 <- QC                       # 오른쪽 정점 위치 (Q^2)
abline(v=Q1-5, lty=3, col="gray65")
abline(v=QB, lty=3, col="gray65")
abline(v=Q2+5, lty=3, col="gray65")
## ---- Q^B에서의 각 효용값: U^A(Q^B), U^C(Q^B), U^B(Q^B) ----
UA_QB <- U(QB, HA, QA, a)
UC_QB <- U(QB, HC, QC, a)
UB_QB <- U(QB, HB, QB, a)
abline(h=UA_QB, lty=3, col="gray65")
abline(h=UC_QB, lty=3, col="gray65")
abline(h=UB_QB, lty=3, col="gray65")
## ---- 축 아래 라벨 (Q^1, Q^B, Q^2) ----
mtext(expression(Q^1), side=1, at=Q1-5, line=1.4, cex=1.5)
mtext(expression(Q^B), side=1, at=QB, line=1.4, cex=1.5)
mtext(expression(Q^2), side=1, at=Q2+5, line=1.4, cex=1.5)
abline(h=0, lwd=1.5, col="black")
## ---- 좌측 y축 라벨 (U^A(Q^B), U^C(Q^B), U^B(Q^B)) ----
# ##    위치는 살짝 왼쪽에 텍스트로 붙임
# text(x=2, y=UA_QB, labels=expression(U^A(Q^B)), adj=c(0,0.5), cex=1.3)
# text(x=2, y=UC_QB, labels=expression(U^C(Q^B)), adj=c(0,0.5), cex=1.3)
# text(x=2, y=UB_QB, labels=expression(U^B(Q^B)), adj=c(0,0.5), cex=1.3)
#
# ## ---- 곡선 하단 라벨 (U^A(Q), U^B(Q), U^C(Q)) ----
# text(QA-10, 5,  labels=expression(U^A(Q)), cex=1.3)
# text(QB,    5,  labels=expression(U^B(Q)), cex=1.3)
# text(QC+10, 5,  labels=expression(U^C(Q)), cex=1.3)
par(oldpar)
#############################
##### 258 page ##### 그림 10-5
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0,100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.8*z
demand_fun_b  <- function(z) 60 - 0.8*z
supply_fun_a <- function(z) 5 + 1*z
supply_fun_b <- function(z) -10 + 1*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "환경정책의 효율성과 형평성",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
#############################
##### 258 page ##### 그림 10-5
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,100)
ylim_all <- c(0,100)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.8*z
demand_fun_b  <- function(z) 40 - 0.8*z
supply_fun_a <- function(z) 25 + 1*z
supply_fun_b <- function(z) -20 + 1*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "환경정책의 효율성과 형평성",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
#############################
##### 258 page ##### 그림 10-5
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,80)
ylim_all <- c(0,80)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.8*z
demand_fun_b  <- function(z) 40 - 0.8*z
supply_fun_a <- function(z) 25 + 1*z
supply_fun_b <- function(z) -20 + 1*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "환경정책의 효율성과 형평성",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
산
## 교차점 계산
diff1 <- function(z) demand_fun_b(z) - supply_fun_a(z)
diff2 <- function(z) demand_fun_a(z) - supply_fun_a(z)
diff3 <- function(z) demand_fun_a(z) - supply_fun_b(z)
#q_star  <- uniroot(diff1, xlim_all)$root
root_pos_a <- uniroot(diff1, c(0, 100))$root
#abline(h = root_pos ,  lty = 2, col = "gray60", lwd = 0.1)
abline(v = supply_fun(root_pos_a) ,  lty = 2, col = "gray60", lwd = 0.1)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
## 교차점 계산
diff1 <- function(z) demand_fun_b(z) - supply_fun_a(z)
diff2 <- function(z) demand_fun_a(z) - supply_fun_a(z)
diff3 <- function(z) demand_fun_a(z) - supply_fun_b(z)
#q_star  <- uniroot(diff1, xlim_all)$root
root_pos_a <- uniroot(diff1, c(0, 100))$root
#abline(h = root_pos ,  lty = 2, col = "gray60", lwd = 0.1)
abline(v = (root_pos_a) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos2 <- uniroot(diff2, c(0, 100))$root
abline(v = (root_pos2) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos3 <- uniroot(diff3, c(0, 100))$root
abline(v = (root_pos3) ,  lty = 2, col = "gray60", lwd = 0.1)
mtext(expression(e[2]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos1,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
root_pos1
root_pos1 <- uniroot(diff1, c(0, 100))$root
abline(v = (root_pos1) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos2 <- uniroot(diff2, c(0, 100))$root
abline(v = (root_pos2) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos3 <- uniroot(diff3, c(0, 100))$root
abline(v = (root_pos3) ,  lty = 2, col = "gray60", lwd = 0.1)
mtext(expression(e[2]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos1,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
#############################
##### 258 page ##### 그림 10-5
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,80)
ylim_all <- c(0,80)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.4*z
demand_fun_b  <- function(z) 40 - 0.4*z
supply_fun_a <- function(z) 25 + 1*z
supply_fun_b <- function(z) -20 + 1*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "중앙정부와 지방자치단체의 환경정책",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
## 교차점 계산
diff1 <- function(z) demand_fun_b(z) - supply_fun_a(z)
diff2 <- function(z) demand_fun_a(z) - supply_fun_a(z)
diff3 <- function(z) demand_fun_a(z) - supply_fun_b(z)
root_pos1 <- uniroot(diff1, c(0, 100))$root
abline(v = (root_pos1) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos2 <- uniroot(diff2, c(0, 100))$root
abline(v = (root_pos2) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos3 <- uniroot(diff3, c(0, 100))$root
abline(v = (root_pos3) ,  lty = 2, col = "gray60", lwd = 0.1)
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,80)
ylim_all <- c(0,80)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.4*z
demand_fun_b  <- function(z) 40 - 0.4*z
supply_fun_a <- function(z) 25 + 0.7*z
supply_fun_b <- function(z) -20 + 0.7*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "중앙정부와 지방자치단체의 환경정책",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
## 교차점 계산
diff1 <- function(z) demand_fun_b(z) - supply_fun_a(z)
diff2 <- function(z) demand_fun_a(z) - supply_fun_a(z)
diff3 <- function(z) demand_fun_a(z) - supply_fun_b(z)
root_pos1 <- uniroot(diff1, c(0, 100))$root
abline(v = (root_pos1) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos2 <- uniroot(diff2, c(0, 100))$root
abline(v = (root_pos2) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos3 <- uniroot(diff3, c(0, 100))$root
abline(v = (root_pos3) ,  lty = 2, col = "gray60", lwd = 0.1)
#############################
##### 258 page ##### 그림 10-5
#############################
## ===== 공통 설정 =====
oldpar <- par(no.readonly = TRUE)
##### 그래프 바깥쪽 여백(margin) 조정정
graph_margin_opt <- c(
5, # 아래쪽 여백
5, # 왼쪽 여백
2, # 위쪽 여백
3  # 오른쪽 여백
)
graph_mgp_opt <- c(
3,  # 축제목(xlab, lab)이 축선에서 떨어져 있는 정도
1,  # 눈금 숫자가 축선에서 떨어져 있는 정도
0   # 축선 자체 위치
)
##### 그래프 선을 여유있게 그릴건지?
graph_xaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
graph_yaxs_opt <- "i"   # i: 딱 정확히, r: 여유있게
##### 축의 눈금(tick)을 표시할건지?
graph_xaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
graph_yaxt_opt <- "n"   # n: tick 안그림,  s: tick 그림
par(mar = graph_margin_opt, mgp = graph_mgp_opt,
xaxs = graph_xaxs_opt, yaxs = graph_yaxs_opt, xaxt= graph_xaxt_opt, yaxt= graph_yaxt_opt)
## x, y 범위
xlim_all <- c(0,80)
ylim_all <- c(0,80)
x <- seq(xlim_all[1], xlim_all[2], length.out = 1000)
## 함수 정의 (function 형태로 정의해야 교차점 자동 계산 가능)
## 공급곡선: 우상향
demand_fun_a  <- function(z) 80 - 0.5*z
demand_fun_b  <- function(z) 40 - 0.5*z
supply_fun_a <- function(z) 25 + 1*z
supply_fun_b <- function(z) -20 + 1*z
## 교차점 계산
#diff1 <- function(z) supply_fun(z)  - demand_fun(z)
#q_star  <- uniroot(diff1, xlim_all)$root
#y_star  <- supply_fun(q_star)
## 빈 캔버스
graph_cex.axis_opt <- 2.0 # 눈금(tick)의 숫자 크기 조절
graph_cex.lab_opt <- 2.0  # 축제목의 크기 조절
graph_cex.main_opt <- 2.0 # 그래프 제목의 글자 크기 조절절
plot(NA, xlim = xlim_all, ylim = ylim_all,
xlab = "배출량", ylab = "금액",
main = "중앙정부와 지방자치단체의 환경정책",
cex.axis = graph_cex.axis_opt,
cex.lab = graph_cex.lab_opt,
cex.main = graph_cex.main_opt)
# 곡선
lines(x, demand_fun_a(x),  lwd = 3, col = "blue")
lines(x, demand_fun_b(x), lwd = 3, col = "blue")
lines(x, supply_fun_a(x),  lwd = 3, col = "blue")
lines(x, supply_fun_b(x), lwd = 3, col = "blue")
## 교차점 계산
diff1 <- function(z) demand_fun_b(z) - supply_fun_a(z)
diff2 <- function(z) demand_fun_a(z) - supply_fun_a(z)
diff3 <- function(z) demand_fun_a(z) - supply_fun_b(z)
root_pos1 <- uniroot(diff1, c(0, 100))$root
abline(v = (root_pos1) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos2 <- uniroot(diff2, c(0, 100))$root
abline(v = (root_pos2) ,  lty = 2, col = "gray60", lwd = 0.1)
root_pos3 <- uniroot(diff3, c(0, 100))$root
abline(v = (root_pos3) ,  lty = 2, col = "gray60", lwd = 0.1)
mtext(expression(e[2]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos1,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
mtext(expression(e^"C"),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos2,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
mtext(expression(e[1]),
side = 1,     # 1:x축, 2:y축, 3:위쪽, 4:오른쪽
at = root_pos3,      # 텍스트 좌표 위치
line = 1.2,   # 축에서 가까운 정도 (숫자가 커지면 축선에서 멀어짐)
cex = 2,      # 글자 크기
las = 1       # 0: 축과평행,  1:수평으로 (똑바르게),  2:축과 수직,  3:항상 수직
)
